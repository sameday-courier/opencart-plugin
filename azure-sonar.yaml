trigger: none

pr:
  branches:
    include:
      - '*'

variables:
  - group: sonar-project-keys
  - group: defectdojo-config
  - name: projectKey
    value: $(PROJECT_KEY_SD.Plugins-opencart-plugin)
  - name: SONAR_PROJECT_KEY
    value: $(PROJECT_KEY_SD.Plugins-opencart-plugin)

resources:
  repositories:
    - repository: templates
      type: git
      name: SD.Plugins        # Azure DevOps repo where template lives
    - repository: SD.CICD
      type: git
      name: SD.CICD           # Azure DevOps repo for CICD templates

stages:
- stage: Sonar
  displayName: "SonarQube Scan"
  jobs:
    - template: templates/sonar-flexible-scan.yaml@templates
      parameters:
        projectKey: $(projectKey)
